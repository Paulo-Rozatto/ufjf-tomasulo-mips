var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},n={},o=e.parcelRequireccd2;null==o&&((o=function(e){if(e in t)return t[e].exports;if(e in n){var o=n[e];delete n[e];var r={id:e,exports:{}};return t[e]=r,o.call(r.exports,r,r.exports),r.exports}var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,t){n[e]=t},e.parcelRequireccd2=o);var r=o("791ri"),s=o("5jcMS"),i=o("2FxLf");i=o("2FxLf");let a,u,l,c,d,y,f,p,v,b,m,w,q,k;const S={init:function(e,t,n,o,r,s,i,v){a=e,u=t,l=n,c=o,d=r,p=s,y=i,f=v},read:function(){v=a.get(y.get()),b=127&v,m=v>>12&7,w=u[b],w?(b==i.TYPES.R&&(w=w[m]),q=l[w.station].find((e=>!e.busy)),k=u[b].getParams(v)):console.warn("operation not found")},write:function(e){f.next(),e(null,null,f),w&&(q?(b==i.TYPES.R?function(){if(!q)return void console.warn("stall");const{rs1:e,rs2:t,rd:n}=k;0!=c[e]?q.qj=c[e]:(q.vj=d[e],q.qj=0);0!=c[t]?q.qk=c[t]:(q.vk=d[t],q.qk=0);q.busy=!0,q.op=w.op,q.opName=w.name,q.cicles=w.cicles,c[n]=q.id}():function(){if(!q)return void console.warn("stall");const{rs1:e,rs2:t,rd:n,imm:o}=k;let r,s;b==i.TYPES.I?(r=e,s=n):(r=t,s=e);0!=c[r]?q.qj=c[r]:(q.vj=d[r],q.qj=0);c[s]=q.id,q.busy=!0,q.op=w.op,q.opName=w.name,q.cicles=w.cicles,q.vk=o,p.push(q)}(),y.next(),e(q,y,f)):console.warn("stall"))}};i=o("2FxLf");let g,$,j,x,h,L,R,T,A,M,B,E,F;const I={init:function(e,t,n,o,r,s,i){g=e,$=t,j=n,x=o,R=r,h=s,L=i},read:function(){T=j[i.ADD_RS].find((e=>e.busy&&0==e.qj&&0==e.qk)),A=j[i.MUL_RS].find((e=>e.busy&&0==e.qj&&0==e.qk));const e=R.head();M=e.busy&&0==e.qj&&0==e.qk?e:null},write:function(e){B=null,E=null,F=null,g.busy?(g.ready||(g.station.cicles--,B=g,0==g.station.cicles&&(g.ready=!0,g.result=g.station.op(g.station.vj,g.station.vk))),g.ready&&0==L.busy&&(L.busy=!0,L.result=g.result,L.station=g.station,g.busy=!1,g.ready=!1,g.station.busy=!1)):T&&(g.busy=!0,g.ready=!1,g.station=T,B=g),$.busy?($.ready||($.station.cicles--,E=$,0==$.station.cicles&&($.ready=!0,$.result=$.station.op($.station.vj,$.station.vk))),$.ready&&0==L.busy&&(L.busy=!0,L.result=$.result,L.station=$.station,$.busy=!1,$.ready=!1,$.station.busy=!1)):A&&($.busy=!0,$.ready=!1,$.station=A,E=$),M&&(M.ready||(M.cicles--,0===M.cicles&&(M.ready=!0,M.vk=M.op(M.vj,M.vk,x,h))),"fld"===M.opName?M.ready&&0==L.busy&&(L.busy=!0,L.result=M.vk,L.station=M,M.busy=!1,M.ready=!1,F=M,R.pop()):M.ready&&(F=M)),e(B,E,F)}};r=o("791ri");let O,N,U,D,P,Q,_,Y,z,C,H;const G={init:function(e,t,n,o,r,s){O=e,N=t,U=n,D=o,P=r,Q=s},read:function(){z=Q.busy,Y=Q.result,_={...Q.station},C=[...U],H={...P.head()}},write:function(e){const t=new Set,n=new Set;if(z){C.forEach(((e,t)=>{e==_.id&&(N[t]=Y,U[t]=0,n.add({id:t,value:Y}))}));Object.values(O).flatMap((e=>e)).forEach((e=>{e.qj==_.id&&(e.qj=0,e.vj=Y,t.add(e)),e.qk==_.id&&(e.qk=0,e.vk=Y,t.add(e))})),Q.result=0,Q.station=null,Q.busy=!1,t.add(_)}if(H&&H.ready&&"fsd"===H.opName){const e=H.vk>>3;D[e]=H.vj,H.busy=!1,H.ready=!1,P.pop(),t.add(H),(0,r.updateMemory)(e,H.vj)}e(t,n)}};r=o("791ri");const J=new ArrayBuffer(512),K=new Float64Array(J),V=new Float64Array(32),W=new Uint8Array(32);let X=[],Z={issue:()=>{},execute:()=>{},writeBack:()=>{}};function ee(e){X=e;const t=e.map((e=>parseInt(e,2)));i.instructions.set(t)}function te(){let e=i.pc.get(),t=i.clock.get();S.read(),I.read(),G.read(),S.write(Z.issue),I.write(Z.execute),G.write(Z.writeBack),(0,r.updateOutput)(e,t,i.instructions.get(e),i.stations,V,K)}S.init(i.instructions,i.operations,i.stations,W,V,i.loadStoreQueue,i.pc,i.clock),I.init(i.adder,i.multiplier,i.stations,V,i.loadStoreQueue,K,i.cdb),G.init(i.stations,V,W,K,i.loadStoreQueue,i.cdb),K[2]=2,(0,r.updateMemory)(2,2),V[1]=1.1,V[5]=5.5,(0,r.updateRegisters)([{id:1,value:1.1},{id:5,value:5}]);const ne=document.querySelector(".menu"),oe=document.querySelector(".menu-button"),re=document.querySelector("#codeTextInput"),se=document.querySelector("#codeFileInput"),ie=document.querySelector("#codeTextOutput"),ae=document.querySelector("#output"),ue=document.querySelector("#uploadModal"),le=document.querySelector("#saveButton"),ce=document.querySelector("#downloadModal"),de=document.querySelector("#downloadButton"),ye=document.querySelector("#reset"),fe=document.querySelector("#run"),pe=document.querySelector("#pause"),ve=document.querySelector("#foward");let be,me="fld $1, 16($12)\nfsd $1, 8($0)\nfmul $6, $1, $5\nfdiv $7, $5, $1\nfadd $2, $1, $5\nfsub $3, $2, $5\nfadd $4, $3, $5\nfadd $5, $4, $5";var we;we={issue:r.issue,execute:r.execute,writeBack:r.writeBack},Z={...Z,...we},ve.onclick=()=>{(0,r.clearActive)(),te()},ye.onclick=()=>{(0,r.init)(),(0,r.clearActive)(),i.pc.reset(),i.clock.reset(),ee(X),i.loadStoreQueue.reset(),K[2]=2,(0,r.updateMemory)(2,2),V[1]=1.1,V[5]=5.5,(0,r.updateRegisters)([{id:1,value:1.1},{id:5,value:5}]),(0,i.resetStations)()},fe.onclick=()=>{(0,r.clearActive)(),te(),be=setInterval((()=>{(0,r.clearActive)(),te()}),1500)},pe.onclick=()=>{clearInterval(be)},oe.onclick=()=>{ne.classList.toggle("menu-visible"),ne.classList.toggle("menu-hidden")},se.onchange=()=>{const e=se.files[0],t=new FileReader;t.onload=e=>{const t=e.target.result;re.innerHTML=t},t.readAsText(e)},le.onclick=()=>{me=re.value.toString().trim(),me=/[a-z]/.test(me)?me.split("\n").map((e=>(0,s.assemblyToBin)(e))):me.split("\n"),(0,r.setInstructions)(me),ee(me)},ue.addEventListener("show.bs.modal",(()=>{se.value="",re.value="string"==typeof me?me:me.join("\n")})),ce.addEventListener("show.bs.modal",(()=>ie.value=ae.value)),de.onclick=e=>{let t=new Blob([ie.value],{type:"text/plain"});e.target.download="resultado.txt",e.target.href=window.URL.createObjectURL(t)};
//# sourceMappingURL=index.783db9e3.js.map
